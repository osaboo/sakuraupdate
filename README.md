# sakuraupdate
Sakura-Editor Update Plugin (alpha version)

プラグインでサクラエディタのバージョンアップ機能を実装してみる

## 機能

1.次のプログラム・ファイルをインターネットからダウンロードして更新します。

* サクラエディタ本体
* ヘルプファイル
* 正規表現ライブラリ

2.サクラエディタ起動時に自動的にチェックすることができます。  
自動チェックは初期設定で7日単位で、無効にすることもできます。  
手動によるチェックもできます。

## インストール手順

1.サクラエディタを起動し、メニューから設定⇒共通設定を起動し、
   プラグインのタブを表示します。
2.「プラグインを有効にする」のチェックボックスのチェックを入れます。
  （入っている場合はそのままでよいです)
3.「ZIPプラグインを導入」ボタンをクリックします。
4.当プラグインのzipファイル(SakuraUpdate.zip)を指定します。
5.プラグイン一覧にsakuraupdateが追加されます。
6.共通設定ウィンドウを「OK」ボタンで閉じます。
7.サクラエディタをいったんすべて終了してから再度起動します。

## 使い方

1.次のコマンドがツールメニューに追加されます。

ソフトウェアの更新  
└更新チェック  
└サクラエディタ更新  
└ヘルプファイル更新  
└正規表現ライブラリ更新  

2.更新チェック  
インターネットサイトのリリースバージョンが更新されているかを確認します。
更新可能な場合は更新することができます。

3.サクラエディタ更新  
サクラエディタ本体のみを更新します。

4.ヘルプファイル更新  
ヘルプファイルのみを更新します。

5.正規表現ライブラリ更新  
正規表現ライブラリのみを更新します。

## 仕様メモ

* 更新対象は、サクラエディタ本体、ヘルプファイル、正規表現ライブラリの3つのみ
* サクラエディタはVer2以降の32bit版
* 動作OSは、XP以降
* C:\Program Files配下へのコピー時は管理者モードでコピー
* SourceForgeとGithubのどちらでもダウンロード可能とする。
* サクラエディタのダウンロードは、SFとGitHubの2種類から選べる
* ヘルプファイルは現状SFのみだが、将来GitHubにリリースされれば取得可能とする。
* ヘルプファイル自身にバージョン情報が無いためタイムスタンプで判定
* ネットからのダウンロードは、MSXMLを使わずcURLで取得。（環境依存の回避)
* zip展開は、7zのコマンドライン版を使用。(これも環境依存の回避)
* vbsをjsに移行したい

